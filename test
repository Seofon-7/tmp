using System;
using System.Data;
using Oracle.ManagedDataAccess.Client;

class Program
{
    static void Main()
    {
        // 連接字符串
        string connectionString = "your_connection_string";

        // 創建原始DataTable並填充數據
        DataTable originalDataTable = new DataTable();
        // 填充原始DataTable...

        // 創建新的DataTable，僅包含需要插入的特定欄位
        DataTable specificColumnsDataTable = new DataTable();
        specificColumnsDataTable.Columns.Add("Column1", typeof(int));
        specificColumnsDataTable.Columns.Add("Column2", typeof(string));
        // 添加更多需要插入的特定欄位

        // 遍歷原始DataTable的每一行，將特定欄位的數據複製到新的DataTable中
        foreach (DataRow originalRow in originalDataTable.Rows)
        {
            DataRow newRow = specificColumnsDataTable.NewRow();
            newRow["Column1"] = originalRow["Column1"];
            newRow["Column2"] = originalRow["Column2"];
            // 複製更多特定欄位的數據
            specificColumnsDataTable.Rows.Add(newRow);
        }

        // 使用上述方法中提供的INSERT命令將新的DataTable中的數據插入到Oracle數據庫中
        using (OracleDataAdapter adapter = new OracleDataAdapter())
        {
            OracleCommand insertCommand = new OracleCommand("INSERT INTO YourTableName (Column1, Column2) VALUES (:Column1, :Column2)", new OracleConnection(connectionString));
            insertCommand.Parameters.Add(":Column1", OracleDbType.Int32, "Column1");
            insertCommand.Parameters.Add(":Column2", OracleDbType.Varchar2, "Column2");
            // 添加更多參數

            adapter.InsertCommand = insertCommand;

            adapter.Update(specificColumnsDataTable);
        }
    }
}  
